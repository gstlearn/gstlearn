## Overview

The R *gstlearn* package is a cross-platform R Package wrapping the [gstlearn C++ Library](https://github.com/gstlearn/gstlearn). It offers to R users **all famous Geostatistical methodologies** developped and/or invented by the Geostatistic Team of the [Geosciences Research Center](https://www.geosciences.minesparis.psl.eu/)!

Copyright (c) MINES PARIS / PSL University

All *gstlearn* outputs can be ploted using *plot* generic function which relies on *ggplot* package.


## References

The R *gstlearn* package is a R wrapper of the [gstlearn C++ Library](https://github.com/gstlearn/gstlearn).

This package contains a modified copy of [findR.cmake](https://github.com/root-project/root) script (see LICENSE.root in *root* folder).

The *gstlearn* R package is a derivative work based on the *swigex* project: [https://github.com/fabien-ors/swigex](https://github.com/fabien-ors/swigex)


## Requirements

1. For using this package, the requirements for building *gstlearn C++ library* must be installed: See [instructions here](https://github.com/gstlearn/gstlearn#required-tools-installation)

2. The following tools must be also available (See [required tools installation](#required-tools-installation) instructions below):

    * SWIG 4.2.0 customized by Fabien Ors (see required tools installation)
    * R 4 or higher with ggplot2 and ggpubr packages (only for plotting)
    * RTools 4 for Windows user

3. Finally, the source code of [gstlearn repository must be cloned](https://github.com/gstlearn/gstlearn#get-the-sources)

Note:

* In a close future, the development tools above won't be needed any more (except R of course) and the gstlearn R package will be installed using install.packages function from a CRAN-like repo.


## Installation

These instructions will compile and install the R package in your usual R libraries directory:

    cmake -Bbuild -H. -DCMAKE_BUILD_TYPE=Release
    cmake --build build --target r_install

or for those who prefer a single command line (see [shortcut Makefile](https://github.com/gstlearn/gstlearn/blob/main/Makefile))

    make r_install


### Important Notes

* Under Windows, using RTools is mandatory for compiling R packages
* Under Windows, using RTools, you may need to add `-G "MSYS Makefiles"` to the first cmake command above
* If you want to build and install the *Debug* version, you must replace `Release` by `Debug` above
* You may need to precise the location of Boost, SWIG or HDF5 installation directory (which contain *include* and *lib* folders). In that case, add the following in the first command above:
  * `-DBoost_ROOT=<path/to/boost>`
  * `-DHDF5_ROOT=<path/to/hdf5>`
  * `-DSWIG_ROOT=<path/to/swig>`


## Usage

    # Load gstlearn package
    suppressWarnings(suppressMessages(library(gstlearn)))
    # Grid size
    nx = 60
    ny = 30
    mygrid = DbGrid_create(c(nx,ny))
    # Add a uniform random field
    var = VH_simulateUniform(nx * ny)
    mygrid$addColumns(var, "var1")
    # Display the field
    plot.grid(mygrid, "var1")

Some tutorials (RMarkdown) are provided in the [demo](https://github.com/gstlearn/gstlearn/tree/main/doc/demo/r) directory of the *gstlearn* github repository.

Some tests (R Scripts) are available in the [tests](https://github.com/gstlearn/gstlearn/tree/main/tests/r) directory of the *gstlearn* github repository.


## Documentation

The classes and functions documentation is provided with the gstlearn package as html files generated by Doxygen (optional). Please refer to gstlearn [README file](https://github.com/gstlearn/gstlearn) for more details. 


## Changelog

Please, look at [CHANGES file](https://github.com/gstlearn/gstlearn/blob/main/CHANGES).


## Required tools installation

This package has been successfully tested with Ubuntu 16/18/20 LTS and Windows 10 (MacOS: not tested)

Warning:

* If you want to install the customized version of SWIG in a target folder of you own, you must add `-DCMAKE_INSTALL_PREFIX:PATH=<path/to/swig>` to cmake command below. In that case, do not forget to indicate the destination path in `SWIG_ROOT` variable (see [Installation section](#Installation)).


### Linux (Ubuntu):

Execute the following command:

    sudo apt install r-base
    sudo apt install bison pcre2-devel # For SWIG (for Ubuntu 18)
    sudo apt install bison pcre2-dev # For SWIG (for Ubuntu 20)

In a folder of your own, compile and install SWIG 4.2.0 [customized] by executing following commands:

    git clone https://github.com/fabien-ors/swig.git
    cd swig
    cmake -Bbuild -DCMAKE_BUILD_TYPE:STRING=Release
    cd build
    make
    sudo make install # Override the already installed swig version (if any)

Finally, install the R required packages from an R command prompt (as sudo) (if you need to plot gstlearn output):

    install.packages(c("ggplot2", "ggpubr"), repos="https://cloud.r-project.org")

Notes:

* If your Linux distribution repository doesn't provide minimum required versions, please install the tools manually (see provider website)

### MacOS:

Execute the following commands (Not tested):

    brew install r
    brew install bison pcre2-devel # For SWIG

Compile and install SWIG 4.2.0 [customized] by executing following commands (not tested):

    mkdir ~/swig_src
    cd ~/swig_src
    git clone https://github.com/fabien-ors/swig.git
    cd swig
    cmake -Bbuild -DCMAKE_BUILD_TYPE:STRING=Release
    cd build
    make
    make install
    
Finally, install the R required packages from an R command prompt (if you need to plot gstlearn output):

    install.packages(c("ggplot2", "ggpubr"), repos="https://cloud.r-project.org")

Notes:

* If your MacOS distribution repository doesn't provide minimum required versions, please install the tools manually (see provider website)

### Windows:

First, install R and RTools with Boost and HDF5 support by following [these instructions](https://github.com/gstlearn/gstlearn#minggw-rtools).

Then, install "bison" GNU tool (from the GnuWin32 tools website):
* Download Setup program here https://gnuwin32.sourceforge.net/packages/bison.htm (see Download section)
* Execute the program and change the installation directory to `C:\<rtools/install/dir>\usr`

Then, from a Windows command prompt, execute following instructions:

    pacman -Sy pcre2-devel
    
Compile and install SWIG 4.2.0 [customized] by executing following commands (not tested):

TODO : Work in progress : trying to mimick file:///home/fors/Projets/swig/Doc/Manual/Windows.html but with no success :-/

    cd
    git clone https://github.com/fabien-ors/swig.git
    cd swig
    cmake -G "MSYS Makefiles" -Bbuild -DCMAKE_BUILD_TYPE:STRING=Release"
    cd build
    make
    make install
    
Finally, install the R required packages from an R command prompt (if you need to plot gstlearn output):

    install.packages(c("ggplot2", "ggpubr"), repos="https://cloud.r-project.org")

Notes:

* The Windows C++ Compiler must be RTools


## Remove installed package

Execute the following command from an R command prompt:

    remove.packages("gstlearn")

---

## License

GPL v3
2022 Team gstlearn
