[[test-facies-simulations-indicators]]
= Test Facies Simulations Indicators

This file is meant to demonstrate the use of gstlearn by loading a numpy
array, transform the continuous variable into a categorical variable
(like a facies variable) and perform some calculations based on the grid
organization (transition probabilities or connectivity)

[[before-running-this-script-make-sure-you-known-where-libpyflumy-module-is-available]]
== Before running this script make sure you known where libpyflumy
module is available:

....
sys.path.append(os.environ['PYFLUMYDIR'])
....


+*Out[1]:*+
----<IPython.core.display.Javascript object>----

[[generate-a-flumy-simulation]]
== Generate a Flumy simulation

Define functions for using and launching Flumy, then use the template
simulation for Alpha reservoir. The simulated grid size is 6400m x 3200m
with a 30m thickness


+*Out[5]:*+
----
Flumy parameters:
DOMAIN_NX = 128
DOMAIN_NY = 64
DOMAIN_DX = 50.0
DOMAIN_DY = 50.0
DOMAIN_SLOPE = 0.001
EROD_COEF = 1.26e-08
CHNL_WIDTH = 350.0
CHNL_WAVELENGTH = 500.0
CHNL_FLW_DIR = 90.0
AV_REG_FREQ = 2
AV_REG_POISSON = 110
AV_LOC_FREQ = 2
AG_OB_FREQ = 2
AG_OB_POISSON = 140
AG_OB_DIST = 1e+30
AG_OB_CONST = 1.0
AG_LV_WIDTH = 6.0
AG_EXP_DEC_THICK = 3267.0
----

[[extract-one-slice-from-the-facies-array]]
== Extract one slice from the facies array


+*Out[6]:*+
----
Unique facies are  [255]

![png](output_10_1.png)
----

[[import-this-array-in-gstlearn]]
== Import this array in gstlearn

The Grid file is created first (defining the origin, mesh size and
count). Then the facies variable is added giving the name and the
locator.


+*Out[7]:*+
----

Data Base Grid Characteristics
==============================

Data Base Summary
-----------------
File is organized as a regular grid
Space dimension              = 2
Number of Columns            = 4
Maximum Number of UIDs       = 4
Total number of samples      = 8192

Grid characteristics:
---------------------
Origin :      0.000     0.000
Mesh   :     50.000    50.000
Number :        128        64

Data Base Extension
-------------------
Coor #1 - Min =      0.000 - Max =   6350.000 - Ext = 6350
Coor #2 - Min =      0.000 - Max =   3150.000 - Ext = 3150

Data Base Statistics
--------------------
1 - Name rank - Locator NA
 Nb of data          =       8192
 Nb of active values =       8192
 Minimum value       =      1.000
 Maximum value       =   8192.000
 Mean value          =   4096.500
 Standard Deviation  =   2364.827
 Variance            = 5592405.250
2 - Name x1 - Locator x1
 Nb of data          =       8192
 Nb of active values =       8192
 Minimum value       =      0.000
 Maximum value       =   6350.000
 Mean value          =   3175.000
 Standard Deviation  =   1847.464
 Variance            = 3413125.000
3 - Name x2 - Locator x2
 Nb of data          =       8192
 Nb of active values =       8192
 Minimum value       =      0.000
 Maximum value       =   3150.000
 Mean value          =   1575.000
 Standard Deviation  =    923.648
 Variance            = 853125.000
4 - Name fac - Locator z1
 Nb of data          =       8192
 Nb of active values =       8192
 Minimum value       =    255.000
 Maximum value       =    255.000
 Mean value          =    255.000
 Standard Deviation  =      0.000
 Variance            =      0.000

Variables
---------
Column = 0 - Name = rank - Locator = NA
Column = 1 - Name = x1 - Locator = x1
Column = 2 - Name = x2 - Locator = x2
Column = 3 - Name = fac - Locator = z1
 ----

[[proportions]]
== Proportions

Calculate facies global proportions


+*Out[8]:*+
----
Facies Proportions
Fac255     100.00%
----

[[transition-probabilities]]
== Transition probabilities

Calculate the transition probabilities for the 2 main directions and for
each facies identifier


+*Out[9]:*+
----
Bound( 1 ) : [ 0.5 ; 1.5 [
 
Data Base Grid Characteristics
==============================

Data Base Summary
-----------------
File is organized as a regular grid
Space dimension              = 2
Number of Columns            = 5
Maximum Number of UIDs       = 5
Total number of samples      = 8192

Grid characteristics:
---------------------
Origin :      0.000     0.000
Mesh   :     50.000    50.000
Number :        128        64

Variables
---------
Column = 0 - Name = rank - Locator = NA
Column = 1 - Name = x1 - Locator = x1
Column = 2 - Name = x2 - Locator = x2
Column = 3 - Name = fac - Locator = NA
Column = 4 - Name = Indicator.fac.Class - Locator = z1----


+*Out[10]:*+
----0----


+*Out[11]:*+
----
Cross-to_simple Variogram ratio G12/G1
======================================
Number of variable(s)       = 1
Number of direction(s)      = 2
Space dimension             = 2
Variance-Covariance Matrix     0.000

Direction #1
------------
Number of lags              = 40
Direction coefficients      =      1.000     0.000
Direction angles (degrees)  =      0.000     0.000
Tolerance on direction      =     90.000 (degrees)
Calculation lag             =     50.000
Tolerance on distance       =     50.000 (Percent of the lag value)

For variable 1
      Rank    Npairs  Distance     Value
         1 64388.000    30.148     0.000
         2 95248.000    53.920     0.000
         3125352.000    75.954     0.000
         4246196.000   101.975     0.000
         5212312.000   128.444     0.000
         6298216.000   152.324     0.000
         7294108.000   176.518     0.000
         8347336.000   200.150     0.000
         9483224.000   226.451     0.000
        10392108.000   252.787     0.000
        11494792.000   276.607     0.000
        12460968.000   300.808     0.000
        13584860.000   325.639     0.000
        14575168.000   351.206     0.000
        15541384.000   375.036     0.000
        16707092.000   400.141     0.000
        17694040.000   426.943     0.000
        18681204.000   452.410     0.000
        19693648.000   476.668     0.000
        20659920.000   500.217     0.000
        21827908.000   524.860     0.000
        22791928.000   551.063     0.000
        23797672.000   576.154     0.000
        24784116.000   600.437     0.000
        25896104.000   625.962     0.000
        26856136.000   651.501     0.000
        27820636.000   676.050     0.000
        28921872.000   700.758     0.000
        29846368.000   725.670     0.000
        30959740.000   750.765     0.000
        31903288.000   776.051     0.000
        32867936.000   800.327     0.000
        33935916.000   824.472     0.000
        34986408.000   850.112     0.000
        35962244.000   875.931     0.000
        36959960.000   901.056     0.000
        37919480.000   926.040     0.000
        38991004.000   950.793     0.000
        39923104.000   975.869     0.000

Direction #2
------------
Number of lags              = 20
Direction coefficients      =      1.000     0.000
Direction angles (degrees)  =      0.000     0.000
Tolerance on direction      =     90.000 (degrees)
Calculation lag             =     50.000
Tolerance on distance       =     50.000 (Percent of the lag value)

For variable 1
      Rank    Npairs  Distance     Value
         1 64388.000    30.148     0.000
         2 95248.000    53.920     0.000
         3125352.000    75.954     0.000
         4246196.000   101.975     0.000
         5212312.000   128.444     0.000
         6298216.000   152.324     0.000
         7294108.000   176.518     0.000
         8347336.000   200.150     0.000
         9483224.000   226.451     0.000
        10392108.000   252.787     0.000
        11494792.000   276.607     0.000
        12460968.000   300.808     0.000
        13584860.000   325.639     0.000
        14575168.000   351.206     0.000
        15541384.000   375.036     0.000
        16707092.000   400.141     0.000
        17694040.000   426.943     0.000
        18681204.000   452.410     0.000
        19693648.000   476.668     0.000----

[[connected-components]]
== Connected Components

Calculate the connected components for each facies.


+*Out[13]:*+
----
![png](output_22_0.png)

![png](output_22_1.png)
----
